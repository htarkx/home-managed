# TCP BBR + fq qdisc + network buffer tuning
# Install to: /etc/sysctl.d/99-bbr.conf

net.core.default_qdisc = fq
net.ipv4.tcp_congestion_control = bbr

# Socket buffer caps (raise defaults from conservative distro values)
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.core.rmem_default = 262144
net.core.wmem_default = 262144

# TCP autotuning ranges (good baseline for high-BDP / bursty traffic)
net.ipv4.tcp_rmem = 4096 131072 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216

# UDP minimum per-socket buffers (helps QUIC/Hysteria under burst/jitter)
net.ipv4.udp_rmem_min = 16384
net.ipv4.udp_wmem_min = 16384

# NIC receive backlog (host can absorb bursts better before userland reads)
net.core.netdev_max_backlog = 4096
